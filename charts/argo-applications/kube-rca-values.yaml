applications:
  argocd:
    enabled: true
    name: argocd
    namespace: argocd
    source:
      repoURL: https://github.com/kube-rca/helm-charts.git
      targetRevision: main
      path: charts/argo-cd
      helm:
        valueFiles:
          - kube-rca-values.yaml
  argo-applications:
    enabled: true
    name: argo-applications
    namespace: argocd
    source:
      repoURL: https://github.com/kube-rca/helm-charts.git
      targetRevision: main
      path: charts/argo-applications
      helm:
        valueFiles:
          - kube-rca-values.yaml
  k8s-resources:
    enabled: true
    name: k8s-resources
    namespace: argocd
    destination:
      namespace: kube-rca
    source:
      repoURL: https://github.com/kube-rca/k8s-resources.git
      targetRevision: main
      path: external-secrets
      directory:
        recurse: true
  ingress-nginx:
    enabled: true
    name: ingress-nginx
    namespace: argocd
    destination:
      namespace: ingress-nginx
    source:
      repoURL: https://github.com/kube-rca/helm-charts.git
      targetRevision: main
      path: charts/ingress-nginx
      helm:
        valueFiles:
          - kube-rca-values.yaml
  postgresql:
    enabled: true
    name: postgresql
    namespace: argocd
    destination:
      namespace: kube-rca
    source:
      repoURL: https://github.com/kube-rca/helm-charts.git
      targetRevision: main
      path: charts/postgresql
      helm:
        valueFiles:
          - kube-rca-values.yaml
  kube-rca:
    enabled: true
    name: kube-rca
    namespace: argocd
    destination:
      namespace: kube-rca
    source:
      repoURL: https://github.com/kube-rca/helm-charts.git
      targetRevision: main
      path: charts/kube-rca
      helm:
        valueFiles:
          - kube-rca-values.yaml
  kube-prometheus-stack:
    enabled: true
    name: kube-prometheus-stack
    namespace: argocd
    destination:
      namespace: monitoring
    source:
      repoURL: https://github.com/kube-rca/helm-charts.git
      targetRevision: main
      path: charts/kube-prometheus-stack
      helm:
        valueFiles:
          - kube-rca-values.yaml
  alloy:
    enabled: true
    name: alloy
    namespace: argocd
    destination:
      namespace: monitoring
    source:
      repoURL: https://github.com/kube-rca/helm-charts.git
      targetRevision: main
      path: charts/alloy
      helm:
        valueFiles:
          - kube-rca-values.yaml
  loki:
    enabled: true
    name: loki
    namespace: argocd
    destination:
      namespace: monitoring
    source:
      repoURL: https://github.com/kube-rca/helm-charts.git
      targetRevision: main
      path: charts/loki
      helm:
        valueFiles:
          - kube-rca-values.yaml
  chaos-mesh:
    enabled: true
    name: chaos-mesh
    namespace: argocd
    destination:
      namespace: chaos-mesh
    source:
      repoURL: https://github.com/kube-rca/helm-charts.git
      targetRevision: main
      path: charts/chaos-mesh
      helm:
        valueFiles:
          - kube-rca-values.yaml
  istio-base:
    enabled: true
    name: istio-base
    namespace: argocd
    destination:
      namespace: istio-system
    syncPolicy:
      syncOptions:
        - ServerSideApply=true
    # istiod가 런타임에 caBundle 패치 시 failurePolicy를 Fail로 변경함
    # 이는 정상 동작이므로 ArgoCD에서 무시
    ignoreDifferences:
      - group: admissionregistration.k8s.io
        kind: ValidatingWebhookConfiguration
        name: istiod-default-validator
        jsonPointers:
          - /webhooks/0/clientConfig/caBundle
          - /webhooks/0/failurePolicy
    source:
      repoURL: https://github.com/kube-rca/helm-charts.git
      targetRevision: main
      path: charts/istio-base
      helm:
        valueFiles:
          - kube-rca-values.yaml
  istio-istiod:
    enabled: true
    name: istio-istiod
    namespace: argocd
    destination:
      namespace: istio-system
    syncPolicy:
      syncOptions:
        - ServerSideApply=true
    source:
      repoURL: https://github.com/kube-rca/helm-charts.git
      targetRevision: main
      path: charts/istio-istiod
      helm:
        valueFiles:
          - kube-rca-values.yaml
  kiali-operator:
    enabled: true
    name: kiali-operator
    namespace: argocd
    destination:
      namespace: kiali-operator
    source:
      repoURL: https://github.com/kube-rca/helm-charts.git
      targetRevision: main
      path: charts/kiali-operator
      helm:
        valueFiles:
          - kube-rca-values.yaml
  microservices-demo:
    enabled: true
    name: microservices-demo
    namespace: argocd
    destination:
      namespace: microservices-demo
    syncPolicy:
      managedNamespaceMetadata:
        labels:
          istio-injection: enabled
    source:
      repoURL: https://github.com/kube-rca/helm-charts.git
      targetRevision: main
      path: charts/microservices-demo
      helm:
        valueFiles:
          - kube-rca-values.yaml
